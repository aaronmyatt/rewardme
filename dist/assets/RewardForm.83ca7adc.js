var Y=Object.defineProperty,G=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var S=(t,s,e)=>s in t?Y(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,b=(t,s)=>{for(var e in s||(s={}))W.call(s,e)&&S(t,e,s[e]);if(j)for(var e of j(s))X.call(s,e)&&S(t,e,s[e]);return t},C=(t,s)=>G(t,J(s));import{c as Z,i as B,R as P,b as ee}from"./index.9f458869.js";import{r as _,m as i,ag as m,ac as ae,ad as te,aV as le,az as se,aa as oe,ab as ne,al as re,af as ue,a_ as ie,aj as $,a9 as de,d as ce,k as fe,j as me,i as ve,l as pe,U as be,aY as ge,o as Ve,f as he,n as g,p as u,a as R,u as f,Y as O,a7 as xe,a8 as ke,Q as ye,B as A,N as _e,P as qe}from"./vendor.2cf8fbd6.js";import{Q as we,a as Ce}from"./QForm.8e0a2642.js";function Ie(t,s){const e=_(null),v=i(()=>t.disable!==!0?null:m("span",{ref:e,class:"no-outline",tabindex:-1}));function V(d){const l=s.value;d!==void 0&&d.type.indexOf("key")===0?l!==null&&document.activeElement!==l&&l.contains(document.activeElement)===!0&&l.focus():e.value!==null&&(d===void 0||l!==null&&l.contains(d.target)===!0)&&e.value.focus()}return{refocusTargetEl:v,refocusTarget:V}}var Qe={xs:30,sm:35,md:40,lg:50,xl:60};const je=C(b(b(b({},oe),ne),re),{modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},toggleOrder:{type:String,validator:t=>t==="tf"||t==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]}),Se=["update:modelValue"];function Be(t,s){const{props:e,slots:v,emit:V,proxy:d}=ue(),{$q:l}=d,c=ae(e,l),p=_(null),{refocusTargetEl:k,refocusTarget:q}=Ie(e,p),r=te(e,Qe),n=i(()=>e.val!==void 0&&Array.isArray(e.modelValue)),h=i(()=>n.value===!0?e.modelValue.indexOf(e.val):-1),o=i(()=>n.value===!0?h.value>-1:e.modelValue===e.trueValue),y=i(()=>n.value===!0?h.value===-1:e.modelValue===e.falseValue),I=i(()=>o.value===!1&&y.value===!1),T=i(()=>e.disable===!0?-1:e.tabindex||0),U=i(()=>`q-${t} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(c.value===!0?` q-${t}--dark`:"")+(e.dense===!0?` q-${t}--dense`:"")+(e.leftLabel===!0?" reverse":"")),z=i(()=>{const a=o.value===!0?"truthy":y.value===!0?"falsy":"indet",x=e.color!==void 0&&(e.keepColor===!0||(t==="toggle"?o.value===!0:y.value!==!0))?` text-${e.color}`:"";return`q-${t}__inner relative-position non-selectable q-${t}__inner--${a}${x}`}),E=i(()=>{const a={type:"checkbox"};return e.name!==void 0&&Object.assign(a,{"^checked":o.value===!0?"checked":void 0,name:e.name,value:n.value===!0?e.val:e.trueValue}),a}),N=ie(E),D=i(()=>{const a={tabindex:T.value,role:"checkbox","aria-label":e.label,"aria-checked":I.value===!0?"mixed":o.value===!0?"true":"false"};return e.disable===!0&&(a["aria-disabled"]="true"),a});function w(a){a!==void 0&&($(a),q(a)),e.disable!==!0&&V("update:modelValue",M(),a)}function M(){if(n.value===!0){if(o.value===!0){const a=e.modelValue.slice();return a.splice(h.value,1),a}return e.modelValue.concat([e.val])}if(o.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(y.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function H(a){(a.keyCode===13||a.keyCode===32)&&$(a)}function L(a){(a.keyCode===13||a.keyCode===32)&&w(a)}const K=s(o,I);return Object.assign(d,{toggle:w}),()=>{const a=K();e.disable!==!0&&N(a,"unshift",` q-${t}__native absolute q-ma-none q-pa-none`);const x=[m("div",{class:z.value,style:r.value},a)];k.value!==null&&x.push(k.value);const Q=e.label!==void 0?le(v.default,[e.label]):se(v.default);return Q!==void 0&&x.push(m("div",{class:`q-${t}__label q-anchor--skip`},Q)),m("div",C(b({ref:p,class:U.value},D.value),{onClick:w,onKeydown:H,onKeyup:L}),x)}}const Pe=m("div",{class:"q-checkbox__bg absolute"},[m("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24","aria-hidden":"true"},[m("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),m("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]);var F=de({name:"QCheckbox",props:je,emits:Se,setup(){return Be("checkbox",()=>()=>[Pe])}});const $e={class:"flex justify-end"},Te=ce({props:{modelValue:null},emits:["submit"],setup(t,{emit:s}){const e=t,v=fe(),V=me(),{getActiveProfile:d}=Z(),l=ve(e.modelValue||{});pe(()=>{const r=d.value;r&&r.id?Object.assign(l,b({profile:r.id,claimed:!1,active:!1},l)):v.notify({type:"warning",caption:"Please add or activate a profile first",timeout:0,closeBtn:!0,actions:[{label:"Go to Profiles",handler:()=>V.push("/profiles")}]})});const c=_(),p=_();be(c,()=>{const r=new FileReader;r.readAsDataURL(c.value),r.onload=async()=>{await B.setImage(c.value.name,r.result),l.image=c.value.name}}),ge(async()=>{l.image&&(p.value=await B.getImage(l.image))});function k(){const r=P.safeParse(l);r.success&&s("submit",r.data)}function q(){Object.assign(l,P.parse(e.modelValue)),c.value=null,p.value=null}return(r,n)=>{const h=ee;return Ve(),he(qe,{flat:""},{default:g(()=>[u(_e,null,{default:g(()=>[R("div",null,[u(h,{jsonable:f(l)},null,8,["jsonable"]),u(we,{class:"q-gutter-md",onSubmit:k,onReset:q},{default:g(()=>[u(O,{modelValue:f(l).name,"onUpdate:modelValue":n[0]||(n[0]=o=>f(l).name=o),label:"What is this reward?",required:"",standout:"bg-primary text-secondary"},null,8,["modelValue"]),u(O,{modelValue:f(l).milestone,"onUpdate:modelValue":n[1]||(n[1]=o=>f(l).milestone=o),modelModifiers:{number:!0},type:"number",label:"Target",required:"",standout:"bg-primary text-secondary",hint:"How many points are needed to achieve this reward?"},null,8,["modelValue"]),u(Ce,{modelValue:c.value,"onUpdate:modelValue":n[2]||(n[2]=o=>c.value=o),label:"A picture of the reward",standout:"bg-primary text-secondary"},{prepend:g(()=>[u(xe,{name:"attach_file"})]),append:g(()=>[u(ke,{square:"",size:"90px"},{default:g(()=>[u(ye,{src:p.value},null,8,["src"])]),_:1})]),_:1},8,["modelValue"]),u(F,{modelValue:f(l).claimed,"onUpdate:modelValue":n[3]||(n[3]=o=>f(l).claimed=o),label:"Have they received this reward already?"},null,8,["modelValue"]),u(F,{modelValue:f(l).active,"onUpdate:modelValue":n[4]||(n[4]=o=>f(l).active=o),label:"Is this the current goal?"},null,8,["modelValue"]),R("div",$e,[u(A,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),u(A,{label:"Submit",type:"submit",color:"primary"})])]),_:1})])]),_:1})]),_:1})}}});export{Te as _};
