import{Q as R,a as m,b as B,_ as C}from"./QForm.f555261d.js";import{d as P,D as h,n as j,C as q,r as d,w as x,p as c,bc as A,o as U,s as D,v as o,g as l,f as p,e as n,y as F,z as N,A as S,B as f,bd as b}from"./index.1b780daa.js";import{Q as k,a as z}from"./QCard.a8620f83.js";import{u as M}from"./use-quasar.3f9d11cc.js";import{u as O}from"./useProfiles.40796a66.js";const E={class:"flex justify-end"},H=P({props:{modelValue:null},emits:["submit"],setup(g,{emit:v}){const i=g,V=M(),_=h(),{getActiveProfile:w}=O(),e=j(i.modelValue||{});q(()=>{const a=w();a&&a.id?Object.assign(e,{...e,profile:a.id}):V.notify({type:"warning",caption:"Please add or activate a profile first",timeout:0,closeBtn:!0,actions:[{label:"Go to Profiles",handler:()=>_.push("/profiles")}]})});const s=d(),u=d();x(s,()=>{const a=new FileReader;a.readAsDataURL(s.value),a.onload=async()=>{await c.setImage(s.value.name,a.result),e.image=s.value.name}}),A(async()=>{e.image&&(u.value=await c.getImage(e.image))});function Q(){const a=b.safeParse(e);a.success&&v("submit",a.data)}function y(){Object.assign(e,b.parse(i.modelValue)),s.value=null,u.value=null}return(a,t)=>{const I=C;return U(),D(z,{flat:""},{default:o(()=>[l(k,null,{default:o(()=>[p("div",null,[l(I,{jsonable:n(e)},null,8,["jsonable"]),l(R,{class:"q-gutter-md",onSubmit:Q,onReset:y},{default:o(()=>[l(m,{modelValue:n(e).name,"onUpdate:modelValue":t[0]||(t[0]=r=>n(e).name=r),label:"Name",required:""},null,8,["modelValue"]),l(m,{modelValue:n(e).milestone,"onUpdate:modelValue":t[1]||(t[1]=r=>n(e).milestone=r),modelModifiers:{number:!0},type:"number",label:"Target",required:""},null,8,["modelValue"]),l(B,{modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=r=>s.value=r),placeholder:n(e).image,outlined:""},{prepend:o(()=>[l(F,{name:"attach_file"})]),append:o(()=>[l(N,{size:"50px"},{default:o(()=>[l(S,{src:u.value},null,8,["src"])]),_:1})]),_:1},8,["modelValue","placeholder"]),p("div",E,[l(f,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),l(f,{label:"Submit",type:"submit",color:"primary"})])]),_:1})])]),_:1})]),_:1})}}});export{H as _};
