import{Q as R,a as m,b as h,_ as q}from"./QForm.9adc67c8.js";import{d as x,H as B,I as C,G as P,q as j,e as A,r as d,w as U,s as c,bh as k,o as D,v as F,x as o,k as l,l as p,b as n,z as N,A as S,B as z,C as f,D as E,E as G,bi as b}from"./index.5dcb4ca1.js";const M={class:"flex justify-end"},J=x({props:{modelValue:null},emits:["submit"],setup(v,{emit:g}){const i=v,V=B(),_=C(),{getActiveProfile:w}=P(),e=j(i.modelValue||{});A(()=>{const a=w();a&&a.id?Object.assign(e,{...e,profile:a.id}):V.notify({type:"warning",caption:"Please add or activate a profile first",timeout:0,closeBtn:!0,actions:[{label:"Go to Profiles",handler:()=>_.push("/profiles")}]})});const s=d(),u=d();U(s,()=>{const a=new FileReader;a.readAsDataURL(s.value),a.onload=async()=>{await c.setImage(s.value.name,a.result),e.image=s.value.name}}),k(async()=>{e.image&&(u.value=await c.getImage(e.image))});function Q(){const a=b.safeParse(e);a.success&&g("submit",a.data)}function y(){Object.assign(e,b.parse(i.modelValue)),s.value=null,u.value=null}return(a,t)=>{const I=q;return D(),F(G,{flat:""},{default:o(()=>[l(E,null,{default:o(()=>[p("div",null,[l(I,{jsonable:n(e)},null,8,["jsonable"]),l(R,{class:"q-gutter-md",onSubmit:Q,onReset:y},{default:o(()=>[l(m,{modelValue:n(e).name,"onUpdate:modelValue":t[0]||(t[0]=r=>n(e).name=r),label:"Name",required:""},null,8,["modelValue"]),l(m,{modelValue:n(e).milestone,"onUpdate:modelValue":t[1]||(t[1]=r=>n(e).milestone=r),modelModifiers:{number:!0},type:"number",label:"Target",required:""},null,8,["modelValue"]),l(h,{modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=r=>s.value=r),placeholder:n(e).image,outlined:""},{prepend:o(()=>[l(N,{name:"attach_file"})]),append:o(()=>[l(S,{size:"50px"},{default:o(()=>[l(z,{src:u.value},null,8,["src"])]),_:1})]),_:1},8,["modelValue","placeholder"]),p("div",M,[l(f,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),l(f,{label:"Submit",type:"submit",color:"primary"})])]),_:1})])]),_:1})]),_:1})}}});export{J as _};
