var K=Object.defineProperty,G=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var S=(t,s,e)=>s in t?K(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,b=(t,s)=>{for(var e in s||(s={}))W.call(s,e)&&S(t,e,s[e]);if(j)for(var e of j(s))X.call(s,e)&&S(t,e,s[e]);return t},_=(t,s)=>G(t,J(s));import{c as Y,i as $,R as B,b as Z}from"./index.f64d7cc5.js";import{r as q,S as i,ag as f,ac as ee,ad as ae,aV as te,az as le,aa as se,ab as oe,al as re,af as ne,aY as ue,aj as P,a9 as ie,d as de,k as ce,j as fe,i as me,l as ve,a6 as pe,aZ as be,o as ge,f as Ve,w as g,m as u,a as R,u as m,X as O,a7 as he,a8 as xe,Q as ke,z as A,L as ye,N as _e}from"./vendor.e940c656.js";import{Q as qe,a as we}from"./QForm.426ff488.js";function Ce(t,s){const e=q(null),v=i(()=>t.disable!==!0?null:f("span",{ref:e,class:"no-outline",tabindex:-1}));function V(d){const l=s.value;d!==void 0&&d.type.indexOf("key")===0?l!==null&&document.activeElement!==l&&l.contains(document.activeElement)===!0&&l.focus():e.value!==null&&(d===void 0||l!==null&&l.contains(d.target)===!0)&&e.value.focus()}return{refocusTargetEl:v,refocusTarget:V}}var Ie={xs:30,sm:35,md:40,lg:50,xl:60};const Qe=_(b(b(b({},se),oe),re),{modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},toggleOrder:{type:String,validator:t=>t==="tf"||t==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]}),je=["update:modelValue"];function Se(t,s){const{props:e,slots:v,emit:V,proxy:d}=ne(),{$q:l}=d,c=ee(e,l),p=q(null),{refocusTargetEl:k,refocusTarget:w}=Ce(e,p),n=ae(e,Ie),r=i(()=>e.val!==void 0&&Array.isArray(e.modelValue)),h=i(()=>r.value===!0?e.modelValue.indexOf(e.val):-1),o=i(()=>r.value===!0?h.value>-1:e.modelValue===e.trueValue),y=i(()=>r.value===!0?h.value===-1:e.modelValue===e.falseValue),I=i(()=>o.value===!1&&y.value===!1),F=i(()=>e.disable===!0?-1:e.tabindex||0),z=i(()=>`q-${t} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(c.value===!0?` q-${t}--dark`:"")+(e.dense===!0?` q-${t}--dense`:"")+(e.leftLabel===!0?" reverse":"")),T=i(()=>{const a=o.value===!0?"truthy":y.value===!0?"falsy":"indet",x=e.color!==void 0&&(e.keepColor===!0||(t==="toggle"?o.value===!0:y.value!==!0))?` text-${e.color}`:"";return`q-${t}__inner relative-position non-selectable q-${t}__inner--${a}${x}`}),E=i(()=>{const a={type:"checkbox"};return e.name!==void 0&&Object.assign(a,{"^checked":o.value===!0?"checked":void 0,name:e.name,value:r.value===!0?e.val:e.trueValue}),a}),N=ue(E),D=i(()=>{const a={tabindex:F.value,role:"checkbox","aria-label":e.label,"aria-checked":I.value===!0?"mixed":o.value===!0?"true":"false"};return e.disable===!0&&(a["aria-disabled"]="true"),a});function C(a){a!==void 0&&(P(a),w(a)),e.disable!==!0&&V("update:modelValue",M(),a)}function M(){if(r.value===!0){if(o.value===!0){const a=e.modelValue.slice();return a.splice(h.value,1),a}return e.modelValue.concat([e.val])}if(o.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(y.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function U(a){(a.keyCode===13||a.keyCode===32)&&P(a)}function H(a){(a.keyCode===13||a.keyCode===32)&&C(a)}const L=s(o,I);return Object.assign(d,{toggle:C}),()=>{const a=L();e.disable!==!0&&N(a,"unshift",` q-${t}__native absolute q-ma-none q-pa-none`);const x=[f("div",{class:T.value,style:n.value},a)];k.value!==null&&x.push(k.value);const Q=e.label!==void 0?te(v.default,[e.label]):le(v.default);return Q!==void 0&&x.push(f("div",{class:`q-${t}__label q-anchor--skip`},Q)),f("div",_(b({ref:p,class:z.value},D.value),{onClick:C,onKeydown:U,onKeyup:H}),x)}}const $e=f("div",{class:"q-checkbox__bg absolute"},[f("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24","aria-hidden":"true"},[f("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),f("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]);var Be=ie({name:"QCheckbox",props:Qe,emits:je,setup(){return Se("checkbox",()=>()=>[$e])}});const Pe={class:"flex justify-end"},ze=de({props:{modelValue:null},emits:["submit"],setup(t,{emit:s}){const e=t,v=ce(),V=fe(),{getActiveProfile:d}=Y(),l=me(e.modelValue||{});ve(()=>{const n=d();n&&n.id?Object.assign(l,_(b({},l),{profile:n.id,claimed:!1})):v.notify({type:"warning",caption:"Please add or activate a profile first",timeout:0,closeBtn:!0,actions:[{label:"Go to Profiles",handler:()=>V.push("/profiles")}]})});const c=q(),p=q();pe(c,()=>{const n=new FileReader;n.readAsDataURL(c.value),n.onload=async()=>{await $.setImage(c.value.name,n.result),l.image=c.value.name}}),be(async()=>{l.image&&(p.value=await $.getImage(l.image))});function k(){const n=B.safeParse(l);n.success&&s("submit",n.data)}function w(){Object.assign(l,B.parse(e.modelValue)),c.value=null,p.value=null}return(n,r)=>{const h=Z;return ge(),Ve(_e,{flat:""},{default:g(()=>[u(ye,null,{default:g(()=>[R("div",null,[u(h,{jsonable:m(l)},null,8,["jsonable"]),u(qe,{class:"q-gutter-md",onSubmit:k,onReset:w},{default:g(()=>[u(O,{modelValue:m(l).name,"onUpdate:modelValue":r[0]||(r[0]=o=>m(l).name=o),label:"What is this reward?",required:"",standout:"bg-primary text-secondary"},null,8,["modelValue"]),u(O,{modelValue:m(l).milestone,"onUpdate:modelValue":r[1]||(r[1]=o=>m(l).milestone=o),modelModifiers:{number:!0},type:"number",label:"Target",required:"",standout:"bg-primary text-secondary",hint:"How many points are needed to achieve this reward?"},null,8,["modelValue"]),u(we,{modelValue:c.value,"onUpdate:modelValue":r[2]||(r[2]=o=>c.value=o),label:"A picture of the reward",standout:"bg-primary text-secondary"},{prepend:g(()=>[u(he,{name:"attach_file"})]),append:g(()=>[u(xe,{square:"",size:"90px"},{default:g(()=>[u(ke,{src:p.value},null,8,["src"])]),_:1})]),_:1},8,["modelValue"]),u(Be,{modelValue:m(l).claimed,"onUpdate:modelValue":r[3]||(r[3]=o=>m(l).claimed=o),label:"Have they received this reward already?"},null,8,["modelValue"]),R("div",Pe,[u(A,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),u(A,{label:"Submit",type:"submit",color:"primary"})])]),_:1})])]),_:1})]),_:1})}}});export{ze as _};
