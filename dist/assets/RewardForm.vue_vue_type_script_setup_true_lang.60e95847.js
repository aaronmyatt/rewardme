import{m as _,n as u,N as c,ap as L,aq as K,bg as h,ba as G,aL as J,an as W,ao as X,az as Y,as as Z,bh as ee,av as S,am as ae,ab as A,d as te,ah as le,u as ne,X as oe,D as se,ai as re,t as ue,a8 as $,be as ie,o as ce,T as de,w as V,b as r,a as Q,e as i,aa as R,B as me,a3 as fe,ac as ve,h as B,ad as be,ae as ge,bi as P,ag as pe}from"./index.a953e485.js";import{Q as he,a as Ve}from"./QForm.9056ba52.js";function xe(l,b){const e=_(null),f=u(()=>l.disable===!0?null:c("span",{ref:e,class:"no-outline",tabindex:-1}));function v(d){const t=b.value;d!==void 0&&d.type.indexOf("key")===0?t!==null&&document.activeElement!==t&&t.contains(document.activeElement)===!0&&t.focus():e.value!==null&&(d===void 0||t!==null&&t.contains(d.target)===!0)&&e.value.focus()}return{refocusTargetEl:f,refocusTarget:v}}const ke={xs:30,sm:35,md:40,lg:50,xl:60},ye={...W,...X,...Y,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:l=>l==="tf"||l==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},_e=["update:modelValue"];function we(l,b){const{props:e,slots:f,emit:v,proxy:d}=Z(),{$q:t}=d,m=L(e,t),p=_(null),{refocusTargetEl:k,refocusTarget:w}=xe(e,p),s=K(e,ke),n=u(()=>e.val!==void 0&&Array.isArray(e.modelValue)),x=u(()=>{const a=h(e.val);return n.value===!0?e.modelValue.findIndex(g=>h(g)===a):-1}),o=u(()=>n.value===!0?x.value>-1:h(e.modelValue)===h(e.trueValue)),y=u(()=>n.value===!0?x.value===-1:h(e.modelValue)===h(e.falseValue)),I=u(()=>o.value===!1&&y.value===!1),O=u(()=>e.disable===!0?-1:e.tabindex||0),F=u(()=>`q-${l} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(m.value===!0?` q-${l}--dark`:"")+(e.dense===!0?` q-${l}--dense`:"")+(e.leftLabel===!0?" reverse":"")),T=u(()=>{const a=o.value===!0?"truthy":y.value===!0?"falsy":"indet",g=e.color!==void 0&&(e.keepColor===!0||(l==="toggle"?o.value===!0:y.value!==!0))?` text-${e.color}`:"";return`q-${l}__inner relative-position non-selectable q-${l}__inner--${a}${g}`}),D=u(()=>{const a={type:"checkbox"};return e.name!==void 0&&Object.assign(a,{"^checked":o.value===!0?"checked":void 0,name:e.name,value:n.value===!0?e.val:e.trueValue}),a}),N=ee(D),z=u(()=>{const a={tabindex:O.value,role:l==="toggle"?"switch":"checkbox","aria-label":e.label,"aria-checked":I.value===!0?"mixed":o.value===!0?"true":"false"};return e.disable===!0&&(a["aria-disabled"]="true"),a});function q(a){a!==void 0&&(S(a),w(a)),e.disable!==!0&&v("update:modelValue",E(),a)}function E(){if(n.value===!0){if(o.value===!0){const a=e.modelValue.slice();return a.splice(x.value,1),a}return e.modelValue.concat([e.val])}if(o.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(y.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function U(a){(a.keyCode===13||a.keyCode===32)&&S(a)}function M(a){(a.keyCode===13||a.keyCode===32)&&q(a)}const H=b(o,I);return Object.assign(d,{toggle:q}),()=>{const a=H();e.disable!==!0&&N(a,"unshift",` q-${l}__native absolute q-ma-none q-pa-none`);const g=[c("div",{class:T.value,style:s.value,"aria-hidden":"true"},a)];k.value!==null&&g.push(k.value);const C=e.label!==void 0?G(f.default,[e.label]):J(f.default);return C!==void 0&&g.push(c("div",{class:`q-${l}__label q-anchor--skip`},C)),c("div",{ref:p,class:F.value,...z.value,onClick:q,onKeydown:U,onKeyup:M},g)}}const qe=c("div",{key:"svg",class:"q-checkbox__bg absolute"},[c("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[c("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),c("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),j=ae({name:"QCheckbox",props:ye,emits:_e,setup(l){function b(e,f){const v=u(()=>(e.value===!0?l.checkedIcon:f.value===!0?l.indeterminateIcon:l.uncheckedIcon)||null);return()=>v.value!==null?[c("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[c(A,{class:"q-checkbox__icon",name:v.value})])]:[qe]}return we("checkbox",b)}}),Ie={class:"flex justify-end"},$e=te({__name:"RewardForm",props:{modelValue:null},emits:["submit"],setup(l,{emit:b}){const e=l,f=le(),v=ne(),{getActiveProfile:d}=oe(),t=se(e.modelValue||{});re(()=>{const s=d.value;s&&s.id?Object.assign(t,{profile:s.id,claimed:!1,active:!1,...t}):f.notify({type:"warning",caption:"Please add or activate a profile first",timeout:0,closeBtn:!0,actions:[{label:"Go to Profiles",handler:()=>v.push("/profiles")}]})});const m=_(),p=_();ue(m,()=>{const s=new FileReader;s.readAsDataURL(m.value);const n=`${m.value.name}_${Date.now()}`;s.onload=async()=>{await $.setImage(n,s.result),t.image=n}}),ie(async()=>{t.image&&(p.value=await $.getImage(t.image))});function k(){const s=P.safeParse(t);s.success&&b("submit",s.data)}function w(){Object.assign(t,P.parse(e.modelValue)),m.value=null,p.value=null}return(s,n)=>{const x=pe;return ce(),de(ge,{flat:""},{default:V(()=>[r(be,null,{default:V(()=>[Q("div",null,[r(x,{jsonable:i(t)},null,8,["jsonable"]),r(he,{class:"q-gutter-md",onSubmit:k,onReset:w},{default:V(()=>[r(R,{modelValue:i(t).name,"onUpdate:modelValue":n[0]||(n[0]=o=>i(t).name=o),label:"What is this reward?",required:"",standout:"bg-primary text-secondary"},null,8,["modelValue"]),r(R,{modelValue:i(t).milestone,"onUpdate:modelValue":n[1]||(n[1]=o=>i(t).milestone=o),modelModifiers:{number:!0},type:"number",label:"Target",required:"",standout:"bg-primary text-secondary",hint:"How many points are needed to achieve this reward?"},null,8,["modelValue"]),r(Ve,{modelValue:i(m),"onUpdate:modelValue":n[2]||(n[2]=o=>me(m)?m.value=o:null),label:"A picture of the reward",standout:"bg-primary text-secondary"},{prepend:V(()=>[r(A,{name:"attach_file"})]),append:V(()=>[r(fe,{square:"",size:"90px"},{default:V(()=>[r(ve,{src:i(p)},null,8,["src"])]),_:1})]),_:1},8,["modelValue"]),r(j,{modelValue:i(t).claimed,"onUpdate:modelValue":n[3]||(n[3]=o=>i(t).claimed=o),label:"Have they received this reward already?"},null,8,["modelValue"]),r(j,{modelValue:i(t).active,"onUpdate:modelValue":n[4]||(n[4]=o=>i(t).active=o),label:"Is this the current goal?"},null,8,["modelValue"]),Q("div",Ie,[r(B,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),r(B,{label:"Submit",type:"submit",color:"primary"})])]),_:1})])]),_:1})]),_:1})}}});export{$e as _};
