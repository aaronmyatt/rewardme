var K=Object.defineProperty,G=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var j=(l,o,e)=>o in l?K(l,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[o]=e,p=(l,o)=>{for(var e in o||(o={}))X.call(o,e)&&j(l,e,o[e]);if(S)for(var e of S(o))W.call(o,e)&&j(l,e,o[e]);return l},C=(l,o)=>G(l,J(o));import{u as Y,i as $,R as B,b as Z}from"./index.1e08156a.js";import{r as y,S as i,aa as m,ah as ee,ai as ae,bl as le,aC as te,af as oe,ag as se,ao as ne,ab as ue,aO as re,am as O,a6 as ie,d as de,k as ce,j as me,i as fe,l as ve,a9 as be,bo as pe,o as ge,f as Ve,w as g,m as r,a as P,u as f,X as R,ad as xe,ae as he,Q as ke,z as A,L as _e,N as Ce}from"./vendor.01a34e97.js";import{Q as ye,a as qe}from"./QForm.f0b5b401.js";function we(l,o){const e=y(null),v=i(()=>l.disable!==!0?null:m("span",{ref:e,class:"no-outline",tabindex:-1}));function V(d){const t=o.value;d!==void 0&&d.type.indexOf("key")===0?t!==null&&document.activeElement!==t&&t.contains(document.activeElement)===!0&&t.focus():e.value!==null&&(d===void 0||t!==null&&t.contains(d.target)===!0)&&e.value.focus()}return{refocusTargetEl:v,refocusTarget:V}}var Ie={xs:30,sm:35,md:40,lg:50,xl:60};const Qe=C(p(p(p({},oe),se),ne),{modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},toggleOrder:{type:String,validator:l=>l==="tf"||l==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]}),Se=["update:modelValue"];function je(l,o){const{props:e,slots:v,emit:V,proxy:d}=ue(),{$q:t}=d,c=ee(e,t),b=y(null),{refocusTargetEl:k,refocusTarget:q}=we(e,b),u=ae(e,Ie),n=i(()=>e.val!==void 0&&Array.isArray(e.modelValue)),x=i(()=>n.value===!0?e.modelValue.indexOf(e.val):-1),s=i(()=>n.value===!0?x.value>-1:e.modelValue===e.trueValue),_=i(()=>n.value===!0?x.value===-1:e.modelValue===e.falseValue),I=i(()=>s.value===!1&&_.value===!1),F=i(()=>e.disable===!0?-1:e.tabindex||0),N=i(()=>`q-${l} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(c.value===!0?` q-${l}--dark`:"")+(e.dense===!0?` q-${l}--dense`:"")+(e.leftLabel===!0?" reverse":"")),T=i(()=>{const a=s.value===!0?"truthy":_.value===!0?"falsy":"indet",h=e.color!==void 0&&(e.keepColor===!0||(l==="toggle"?s.value===!0:_.value!==!0))?` text-${e.color}`:"";return`q-${l}__inner relative-position non-selectable q-${l}__inner--${a}${h}`}),z=i(()=>{const a={type:"checkbox"};return e.name!==void 0&&Object.assign(a,{"^checked":s.value===!0?"checked":void 0,name:e.name,value:n.value===!0?e.val:e.trueValue}),a}),E=re(z),D=i(()=>{const a={tabindex:F.value,role:"checkbox","aria-label":e.label,"aria-checked":I.value===!0?"mixed":s.value===!0?"true":"false"};return e.disable===!0&&(a["aria-disabled"]="true"),a});function w(a){a!==void 0&&(O(a),q(a)),e.disable!==!0&&V("update:modelValue",M(),a)}function M(){if(n.value===!0){if(s.value===!0){const a=e.modelValue.slice();return a.splice(x.value,1),a}return e.modelValue.concat([e.val])}if(s.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(_.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function U(a){(a.keyCode===13||a.keyCode===32)&&O(a)}function L(a){(a.keyCode===13||a.keyCode===32)&&w(a)}const H=o(s,I);return Object.assign(d,{toggle:w}),()=>{const a=H();e.disable!==!0&&E(a,"unshift",` q-${l}__native absolute q-ma-none q-pa-none`);const h=[m("div",{class:T.value,style:u.value},a)];k.value!==null&&h.push(k.value);const Q=e.label!==void 0?le(v.default,[e.label]):te(v.default);return Q!==void 0&&h.push(m("div",{class:`q-${l}__label q-anchor--skip`},Q)),m("div",C(p({ref:b,class:N.value},D.value),{onClick:w,onKeydown:U,onKeyup:L}),h)}}const $e=m("div",{class:"q-checkbox__bg absolute"},[m("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24","aria-hidden":"true"},[m("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),m("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]);var Be=ie({name:"QCheckbox",props:Qe,emits:Se,setup(){return je("checkbox",()=>()=>[$e])}});const Oe={class:"flex justify-end"},Ne=de({props:{modelValue:null},emits:["submit"],setup(l,{emit:o}){const e=l,v=ce(),V=me(),{getActiveProfile:d}=Y(),t=fe(e.modelValue||{});ve(()=>{const u=d();u&&u.id?Object.assign(t,C(p({},t),{profile:u.id,claimed:!1})):v.notify({type:"warning",caption:"Please add or activate a profile first",timeout:0,closeBtn:!0,actions:[{label:"Go to Profiles",handler:()=>V.push("/profiles")}]})});const c=y(),b=y();be(c,()=>{const u=new FileReader;u.readAsDataURL(c.value),u.onload=async()=>{await $.setImage(c.value.name,u.result),t.image=c.value.name}}),pe(async()=>{t.image&&(b.value=await $.getImage(t.image))});function k(){const u=B.safeParse(t);u.success&&o("submit",u.data)}function q(){Object.assign(t,B.parse(e.modelValue)),c.value=null,b.value=null}return(u,n)=>{const x=Z;return ge(),Ve(Ce,{flat:""},{default:g(()=>[r(_e,null,{default:g(()=>[P("div",null,[r(x,{jsonable:f(t)},null,8,["jsonable"]),r(ye,{class:"q-gutter-md",onSubmit:k,onReset:q},{default:g(()=>[r(R,{modelValue:f(t).name,"onUpdate:modelValue":n[0]||(n[0]=s=>f(t).name=s),label:"Name",required:""},null,8,["modelValue"]),r(R,{modelValue:f(t).milestone,"onUpdate:modelValue":n[1]||(n[1]=s=>f(t).milestone=s),modelModifiers:{number:!0},type:"number",label:"Target",required:""},null,8,["modelValue"]),r(qe,{modelValue:c.value,"onUpdate:modelValue":n[2]||(n[2]=s=>c.value=s),placeholder:f(t).image,outlined:""},{prepend:g(()=>[r(xe,{name:"attach_file"})]),append:g(()=>[r(he,{size:"50px"},{default:g(()=>[r(ke,{src:b.value},null,8,["src"])]),_:1})]),_:1},8,["modelValue","placeholder"]),r(Be,{modelValue:f(t).claimed,"onUpdate:modelValue":n[3]||(n[3]=s=>f(t).claimed=s),label:"Claimed?"},null,8,["modelValue"]),P("div",Oe,[r(A,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),r(A,{label:"Submit",type:"submit",color:"primary"})])]),_:1})])]),_:1})]),_:1})}}});export{Ne as _};
