var K=Object.defineProperty,G=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var S=(l,o,e)=>o in l?K(l,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[o]=e,b=(l,o)=>{for(var e in o||(o={}))W.call(o,e)&&S(l,e,o[e]);if(j)for(var e of j(o))X.call(o,e)&&S(l,e,o[e]);return l},y=(l,o)=>G(l,J(o));import{u as Y,i as B,R as $,b as Z}from"./index.f71908f2.js";import{r as C,T as i,aa as f,ag as ee,ah as ae,bk as le,aB as te,ae as oe,af as se,an as ne,ab as ue,aN as re,al as O,a6 as ie,d as de,k as ce,j as fe,i as me,l as ve,a9 as pe,bn as be,o as ge,f as Ve,w as g,m as r,a as P,u as m,W as R,ad as xe,n as he,Q as ke,A,M as _e,O as ye}from"./vendor.a01d6254.js";import{Q as Ce,a as qe}from"./QForm.f7c96947.js";function we(l,o){const e=C(null),v=i(()=>l.disable!==!0?null:f("span",{ref:e,class:"no-outline",tabindex:-1}));function V(d){const t=o.value;d!==void 0&&d.type.indexOf("key")===0?t!==null&&document.activeElement!==t&&t.contains(document.activeElement)===!0&&t.focus():e.value!==null&&(d===void 0||t!==null&&t.contains(d.target)===!0)&&e.value.focus()}return{refocusTargetEl:v,refocusTarget:V}}var Ie={xs:30,sm:35,md:40,lg:50,xl:60};const Qe=y(b(b(b({},oe),se),ne),{modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},toggleOrder:{type:String,validator:l=>l==="tf"||l==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]}),je=["update:modelValue"];function Se(l,o){const{props:e,slots:v,emit:V,proxy:d}=ue(),{$q:t}=d,c=ee(e,t),p=C(null),{refocusTargetEl:k,refocusTarget:q}=we(e,p),u=ae(e,Ie),n=i(()=>e.val!==void 0&&Array.isArray(e.modelValue)),x=i(()=>n.value===!0?e.modelValue.indexOf(e.val):-1),s=i(()=>n.value===!0?x.value>-1:e.modelValue===e.trueValue),_=i(()=>n.value===!0?x.value===-1:e.modelValue===e.falseValue),I=i(()=>s.value===!1&&_.value===!1),F=i(()=>e.disable===!0?-1:e.tabindex||0),T=i(()=>`q-${l} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(c.value===!0?` q-${l}--dark`:"")+(e.dense===!0?` q-${l}--dense`:"")+(e.leftLabel===!0?" reverse":"")),N=i(()=>{const a=s.value===!0?"truthy":_.value===!0?"falsy":"indet",h=e.color!==void 0&&(e.keepColor===!0||(l==="toggle"?s.value===!0:_.value!==!0))?` text-${e.color}`:"";return`q-${l}__inner relative-position non-selectable q-${l}__inner--${a}${h}`}),E=i(()=>{const a={type:"checkbox"};return e.name!==void 0&&Object.assign(a,{"^checked":s.value===!0?"checked":void 0,name:e.name,value:n.value===!0?e.val:e.trueValue}),a}),M=re(E),z=i(()=>{const a={tabindex:F.value,role:"checkbox","aria-label":e.label,"aria-checked":I.value===!0?"mixed":s.value===!0?"true":"false"};return e.disable===!0&&(a["aria-disabled"]="true"),a});function w(a){a!==void 0&&(O(a),q(a)),e.disable!==!0&&V("update:modelValue",D(),a)}function D(){if(n.value===!0){if(s.value===!0){const a=e.modelValue.slice();return a.splice(x.value,1),a}return e.modelValue.concat([e.val])}if(s.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(_.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function U(a){(a.keyCode===13||a.keyCode===32)&&O(a)}function L(a){(a.keyCode===13||a.keyCode===32)&&w(a)}const H=o(s,I);return Object.assign(d,{toggle:w}),()=>{const a=H();e.disable!==!0&&M(a,"unshift",` q-${l}__native absolute q-ma-none q-pa-none`);const h=[f("div",{class:N.value,style:u.value},a)];k.value!==null&&h.push(k.value);const Q=e.label!==void 0?le(v.default,[e.label]):te(v.default);return Q!==void 0&&h.push(f("div",{class:`q-${l}__label q-anchor--skip`},Q)),f("div",y(b({ref:p,class:T.value},z.value),{onClick:w,onKeydown:U,onKeyup:L}),h)}}const Be=f("div",{class:"q-checkbox__bg absolute"},[f("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24","aria-hidden":"true"},[f("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),f("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]);var $e=ie({name:"QCheckbox",props:Qe,emits:je,setup(){return Se("checkbox",()=>()=>[Be])}});const Oe={class:"flex justify-end"},Te=de({props:{modelValue:null},emits:["submit"],setup(l,{emit:o}){const e=l,v=ce(),V=fe(),{getActiveProfile:d}=Y(),t=me(e.modelValue||{});ve(()=>{const u=d();u&&u.id?Object.assign(t,y(b({},t),{profile:u.id,claimed:!1})):v.notify({type:"warning",caption:"Please add or activate a profile first",timeout:0,closeBtn:!0,actions:[{label:"Go to Profiles",handler:()=>V.push("/profiles")}]})});const c=C(),p=C();pe(c,()=>{const u=new FileReader;u.readAsDataURL(c.value),u.onload=async()=>{await B.setImage(c.value.name,u.result),t.image=c.value.name}}),be(async()=>{t.image&&(p.value=await B.getImage(t.image))});function k(){const u=$.safeParse(t);u.success&&o("submit",u.data)}function q(){Object.assign(t,$.parse(e.modelValue)),c.value=null,p.value=null}return(u,n)=>{const x=Z;return ge(),Ve(ye,{flat:""},{default:g(()=>[r(_e,null,{default:g(()=>[P("div",null,[r(x,{jsonable:m(t)},null,8,["jsonable"]),r(Ce,{class:"q-gutter-md",onSubmit:k,onReset:q},{default:g(()=>[r(R,{modelValue:m(t).name,"onUpdate:modelValue":n[0]||(n[0]=s=>m(t).name=s),label:"Name",required:""},null,8,["modelValue"]),r(R,{modelValue:m(t).milestone,"onUpdate:modelValue":n[1]||(n[1]=s=>m(t).milestone=s),modelModifiers:{number:!0},type:"number",label:"Target",required:""},null,8,["modelValue"]),r(qe,{modelValue:c.value,"onUpdate:modelValue":n[2]||(n[2]=s=>c.value=s),placeholder:m(t).image,outlined:""},{prepend:g(()=>[r(xe,{name:"attach_file"})]),append:g(()=>[r(he,{size:"50px"},{default:g(()=>[r(ke,{src:p.value},null,8,["src"])]),_:1})]),_:1},8,["modelValue","placeholder"]),r($e,{modelValue:m(t).claimed,"onUpdate:modelValue":n[3]||(n[3]=s=>m(t).claimed=s),label:"Claimed?"},null,8,["modelValue"]),P("div",Oe,[r(A,{label:"Reset",type:"reset",color:"primary",flat:"",class:"q-ml-sm"}),r(A,{label:"Submit",type:"submit",color:"primary"})])]),_:1})])]),_:1})]),_:1})}}});export{Te as _};
